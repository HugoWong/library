(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{371:function(s,t,a){"use strict";a.r(t);var r=a(3),e=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("常见的分布式存储开源软件有：GlusterFS、Ceph、HDFS、MooseFS、FastDFS 等它，它们都有以下几个优点：")]),s._v(" "),t("ul",[t("li",[s._v("扩容方便，轻松达到 PB 级别或以上")]),s._v(" "),t("li",[s._v("提升读写性能（LB）或数据高可用（HA）")]),s._v(" "),t("li",[s._v("避免单个节点故障导致整个架构问题")]),s._v(" "),t("li",[s._v("价格相对便宜，大量的廉价设备就可以组成")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.gluster.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gluster"),t("OutboundLink")],1),s._v("FS（GNU ClusterFile System）是一种全对称的开源分布式文件系统，所谓全对称是指 GlusterFS 采用弹性哈希算法，没有中心节点，所有节点全部平等，部署配置方便。")]),s._v(" "),t("h2",{attrs:{id:"特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[s._v("#")]),s._v(" 特性")]),s._v(" "),t("p",[s._v("全对称架构、支持多种卷类型(类似 RAID0/1/5/10/01)、支持卷级别的压缩、支持 FUSE、支持 NFS、支持 SMB、支持 Hadoop、支持 OpenStack、与 oVirt 深度整合。")]),s._v(" "),t("h2",{attrs:{id:"概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),t("p",[s._v("birck：GlusterFS 的基本元素，以节点服务器目录形式展现"),t("br"),s._v("\nvolume：多个 brick 的逻辑集合"),t("br"),s._v("\nmetadata：元数据，用于描述文件、目录等的信息"),t("br"),s._v("\nself-heal：用于后台运行检测副本卷中文件和目录的不一致性并解决这些不一致"),t("br"),s._v("\nFUSE：Filesystem Userspace 是一个可加载的内核模块，其支持非特权用户创建自己的文件系统而不需要修改内核代码通过在用户空间运行文件系统的代码通过 FUSE 代码与内核进行桥接"),t("br"),s._v("\nGluster Server：数据存储服务器，即组成 GlusterFS 存储集群的节点"),t("br"),s._v("\nGluster Client：使用 GlusterFS 存储服务的服务器，如 KVM、OpenStack、LB RealServer、HA node")]),s._v(" "),t("h2",{attrs:{id:"部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://download.gluster.org/pub/gluster/glusterfs/LATEST/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.gluster.org/pub/gluster/glusterfs/LATEST/"),t("OutboundLink")],1),s._v(" "),t("a",{attrs:{href:"https://download.gluster.org/pub/gluster/glusterfs/LATEST/glusterfs-10.2.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.gluster.org/pub/gluster/glusterfs/LATEST/glusterfs-10.2.tar.gz"),t("OutboundLink")],1),s._v("\n存储集群的搭建主要指的是服务端的部署，客户端使用的时候挂载就好了")]),s._v(" "),t("h3",{attrs:{id:"服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务器"}},[s._v("#")]),s._v(" 服务器")]),s._v(" "),t("p",[s._v("准备三台存储服务器，修改 hosts 文件")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("xxx.xxx.xxx.xxx node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v("\nxxx.xxx.xxx.xxx node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),s._v("\nxxx.xxx.xxx.xxx node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("安装 GlusterFS 服务器端")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("yum install glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server\nyum install glusterfs glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fuse\n#添加开机启动\nsystemctl enable glusterd\n#启动、关闭服务\nsystemctl start glusterd\nsystemctl "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("stop")]),s._v(" glusterd\n#服务状态\nsystemctl "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("status")]),s._v(" glusterd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("创建分区（或者现有分区），挂载到服务器单独目录上，准备加入 GlusterFS 集群")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("fdisk "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("l\n#创建 XFS 分区\nmkfs.xfs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("i "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("vdb1\n#挂载分区\necho '"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("vdb1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("glusterfs xfs defaults "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("'  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("fstab\nmount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" mount\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"信任池"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#信任池"}},[s._v("#")]),s._v(" 信任池")]),s._v(" "),t("p",[s._v("任意开启 GlusterFS 服务的主机上将其他主机加入到信任的主机池里")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("#添加到信任池中\ngluster peer probe node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),s._v("\ngluster peer probe node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),s._v("\ngluster peer "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("status")]),s._v("\n\ngluster volume create\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("export"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("vdb1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" mount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("export"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("vdb1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("brick\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"逻辑卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#逻辑卷"}},[s._v("#")]),s._v(" 逻辑卷")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("gluster volume create gv0 replica "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" \\\nnode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gv0 \\\nnode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gv0 \\\nnode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gv0\n\ngluster volume info\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("常见卷的模式")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("卷模式")]),s._v(" "),t("th",[s._v("描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("Replicated")]),s._v(" "),t("td",[s._v("复制卷，类似 RAID1")])]),s._v(" "),t("tr",[t("td",[s._v("Striped（新版本会弃用）")]),s._v(" "),t("td",[s._v("条带卷，类似 RAID0")])]),s._v(" "),t("tr",[t("td",[s._v("Distributed")]),s._v(" "),t("td",[s._v("分布卷")])]),s._v(" "),t("tr",[t("td",[s._v("Distribute Replicated")]),s._v(" "),t("td",[s._v("分布与复制组合")])]),s._v(" "),t("tr",[t("td",[s._v("Dispersed")]),s._v(" "),t("td",[s._v("类似RAID5、RAID6")])])])]),s._v(" "),t("h2",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),t("h3",{attrs:{id:"挂载卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#挂载卷"}},[s._v("#")]),s._v(" 挂载卷")]),s._v(" "),t("p",[s._v("挂载的 IP 选集群任意一个 IP 即可，冒号后接逻辑卷名")]),s._v(" "),t("div",{staticClass:"language-basic line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-basic"}},[t("code",[s._v("yum install glusterfs glusterfs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fuse\n#挂载 gv0 卷\nmount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t glusterfs xxx.xxx.xxx.xxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gv0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("glusterfs\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);