(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{406:function(s,a,t){"use strict";t.r(a);var e=t(3),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("守护进程，英文名：“daemon”，是一个在后台运行并且不受任何终端控制的进程，不会随着会话结束而退出；就是常说的后台运行。\n常见的相应工具有Supervisor和nohup，而pm2相对于Supervisor没有配置，不用输很长的命令、相对于nohup管理进程方便。")]),s._v(" "),a("h2",{attrs:{id:"nodejs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nodejs"}},[s._v("#")]),s._v(" NodeJS")]),s._v(" "),a("p",[s._v("pm2是一个高级的NodeJS进程管理工具，使用pm2需要安装NodeJS，详细操作见下文：\n"),a("RouterLink",{attrs:{to:"/pages/nodejs/"}},[s._v("Node.JS 环境搭建")])],1),s._v(" "),a("h3",{attrs:{id:"修改镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改镜像"}},[s._v("#")]),s._v(" 修改镜像")]),s._v(" "),a("p",[s._v("修改成阿里云镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npmmirror.com\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#验证")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config get registry\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#返回 https://registry.npmmirror.com 表示成功")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"pm2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2"}},[s._v("#")]),s._v(" PM2")]),s._v(" "),a("h3",{attrs:{id:"在线安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在线安装"}},[s._v("#")]),s._v(" 在线安装")]),s._v(" "),a("p",[s._v("安装完NodeJS就可以使用"),a("code",[s._v("npm")]),s._v("命令了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i pm2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/nodejs/bin/pm2 /usr/bin/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"离线安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#离线安装"}},[s._v("#")]),s._v(" 离线安装")]),s._v(" "),a("p",[s._v("进入模块文件夹：/usr/local/node/lib/node_modules，压缩")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/node/lib/node_modules\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-czvf")]),s._v(" pm2.tar.gz pm2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("将压缩包拷贝到离线设备 /usr/local/node/lib/node_modules 目录下")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/node/lib/node_modules\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" pm2.tar.gz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("解压完成后，尝试运行")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/usr/local/node/lib/node_modules/pm2/bin/pm2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"软连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软连接"}},[s._v("#")]),s._v(" 软连接")]),s._v(" "),a("p",[s._v("这样我们可以直接使用 pm2 全局命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置 node 变量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/node/lib/node_modules/pm2/bin/pm2  /usr/local/node/bin/pm2\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/node/lib/node_modules/pm2/bin/pm2-dev  /usr/local/node/bin/pm2-dev\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/node/lib/node_modules/pm2/bin/pm2-docker  /usr/local/node/bin/pm2-docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/node/lib/node_modules/pm2/bin/pm2-runtime  /usr/local/node/bin/pm2-runtime\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置全局变量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/node/bin/pm2 /usr/local/bin/pm2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"开始使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始使用"}},[s._v("#")]),s._v(" 开始使用")]),s._v(" "),a("h3",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("命令")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("pm2 update")]),s._v(" "),a("td",[s._v("更新版本")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 list")]),s._v(" "),a("td",[s._v("显示所有进程状态")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 startup")]),s._v(" "),a("td",[s._v("产生 init 脚本，保持进程后台运行")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 monit name")]),s._v(" "),a("td",[s._v("监视指定（所有）进程，查看进程的资源消耗情况等")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 log name")]),s._v(" "),a("td",[s._v("显示指定（所有）日志")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 stop name(all)")]),s._v(" "),a("td",[s._v("停止指定（所有）进程")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 restart name(all)")]),s._v(" "),a("td",[s._v("重启指定（所有）进程")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 reload name(all)")]),s._v(" "),a("td",[s._v("0 秒停机重载进程 (用于 NETWORKED 进程)")])]),s._v(" "),a("tr",[a("td",[s._v("pm2 selete name(all)")]),s._v(" "),a("td",[s._v("删除指定（所有）进程")])])])]),s._v(" "),a("h3",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("背景：用 .NET Core 搭建了个小应用，可以部署的闲置服务器系统是 Linux，于是先部署了相应的运行环境\n"),a("a",{attrs:{href:"https://www.yuque.com/ryds/op/olxabx?view=doc_embed",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux 搭建 .NET 环境"),a("OutboundLink")],1),s._v("\n直接将发布后的文件上传到服务器，进入到应用所在目录，执行一下语句即可")]),s._v(" "),a("blockquote",[a("p",[s._v(".NET Core 应用程序需要 runtimeconfig.json 文件")])]),s._v(" "),a("div",{staticClass:"language-basic line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-basic"}},[a("code",[s._v("pm2 start "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dotnet test.dll"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("name")]),s._v(" test\npm2 monit test\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);