(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{458:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一、容器简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、容器简介"}},[s._v("#")]),s._v(" 一、容器简介")]),s._v(" "),a("p",[s._v("容器是操作系统级的进程虚拟化，它对进程进行封装，使其共享操作系统内核的同时相互隔离、互不影响；相较于传统虚拟机更加轻量化，性能更加优良，系统负载更低，资源利用率更高；关键作用：它能"),a("strong",[s._v("保证代码运行环境的一致性")]),s._v("。")]),s._v(" "),a("p",[s._v("Docker 就是目前相当成熟的一个开源的应用容器引擎，容器集群目前有 Swarm & Kubernetes；看客户实际使用的是什么，我们只需要准备镜像即可。")]),s._v(" "),a("p",[s._v("Docker 镜像可以简单看为一个软件包，这个软件包能提供应用程序完整的运行时环境：应用程序的代码、相关的配置文件、应用程序所需的依赖库等等。"),a("br"),s._v(" "),a("img",{attrs:{src:"https://f.pz.al/pzal/2023/01/17/2cd4286958c1d.jpg",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"二、容器入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、容器入门"}},[s._v("#")]),s._v(" 二、容器入门")]),s._v(" "),a("h3",{attrs:{id:"_1-快捷安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-快捷安装"}},[s._v("#")]),s._v(" 1.快捷安装")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改阿里源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/docker-ce.repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[docker-ce-stable]\nname=Docker CE Stable\nbaseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable\nenabled=1\ngpgcheck=0\ngpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg\nEOF")]),s._v("\n\nyum list docker-ce.x86_64 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--showduplicates")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-20.10.10\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#官方脚本安装")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://get.docker.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("安装完成以后启动并添加自启")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置自启动")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动 Docker")]),s._v("\nsystemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_2-修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改配置"}},[s._v("#")]),s._v(" 2.修改配置")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('EOF\n{\n  "registry-mirrors": ["https://ustc-edu-cn.mirror.aliyuncs.com"\n}\nEOF')]),s._v("\n\nsystemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" Cgroup\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("镜像加速")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("源名称")])]),s._v(" "),a("th",[a("strong",[s._v("源地址")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("Azure")]),s._v(" "),a("td",[s._v("https://dockerhub.azk8s.cn")])]),s._v(" "),a("tr",[a("td",[s._v("中科大")]),s._v(" "),a("td",[s._v("https://docker.mirrors.ustc.edu.cn")])]),s._v(" "),a("tr",[a("td",[s._v("中科大")]),s._v(" "),a("td",[s._v("https://ustc-edu-cn.mirror.aliyuncs.com")])]),s._v(" "),a("tr",[a("td",[s._v("阿里云")]),s._v(" "),a("td",[s._v("https://"),a("ID",[s._v(".mirror.aliyuncs.com")])],1)]),s._v(" "),a("tr",[a("td",[s._v("网易云")]),s._v(" "),a("td",[s._v("https://hub-mirror.c.163.com")])]),s._v(" "),a("tr",[a("td",[s._v("七牛云")]),s._v(" "),a("td",[s._v("https://reg-mirror.qiniu.com")])]),s._v(" "),a("tr",[a("td",[s._v("腾讯云")]),s._v(" "),a("td",[s._v("https://mirror.ccs.tencentyun.com")])])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://f.pz.al/pzal/2023/01/13/8b18b3f869998.png",alt:"image.png"}})]),s._v(" "),a("h3",{attrs:{id:"_3-授权用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-授权用户"}},[s._v("#")]),s._v(" 3.授权用户")]),s._v(" "),a("h4",{attrs:{id:"_3-1-sudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-sudo"}},[s._v("#")]),s._v(" 3.1.sudo")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sudo，需要加入 /etc/sudoers 文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("640")]),s._v(" /etc/sudoers\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sudoers\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第一列：root 即用户账号")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第二列：ALL 指登陆者来源主机；括号中的 ALL 指目标用户，即以谁的身份去执行命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#第三列：ALL 指命令名，想免除密码输入加上 NOPASSWD:ALL")]),s._v("\nroot  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  ALL\napp   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  NOPASSWD:ALL\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("440")]),s._v(" /etc/sudoers\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"_3-2-加入群组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-加入群组"}},[s._v("#")]),s._v(" 3.2.加入群组")]),s._v(" "),a("p",[s._v("Docker 安装之后默认会创建 docker 组，它拥有读取套接字权限，因此将该普通用户加入 docker 组就有访问 unix 套接字的权限，然后刷新用户的初始组即可。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询 docker 组是否创建，不存在需要手动创建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/group "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询套接字是否是 docker 组，不是需要修改")]),s._v("\nll /var/run/docker.sock\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" /var/run/docker.sock\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将用户加入 docker 组，然后刷新用户组")]),s._v("\ngpasswd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" xxx "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用该用户更新用户组")]),s._v("\nnewgrp "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_4-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-常用命令"}},[s._v("#")]),s._v(" 4.常用命令")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://f.pz.al/pzal/2023/01/13/c24f55ecd5ae6.png",alt:"image.png"}})]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看运行中的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有容器，包括停止的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看安裝的镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#正常停止容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动已有容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#强制停止容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器，运行脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看容器日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除指定 ID 的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除指定 ID 的镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("镜像名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看 Volume 列表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看网络列表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"三、容器镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、容器镜像"}},[s._v("#")]),s._v(" 三、容器镜像")]),s._v(" "),a("h3",{attrs:{id:"_1-拉取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-拉取镜像"}},[s._v("#")]),s._v(" 1.拉取镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#从镜像仓库中拉取或者更新指定镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull nginx:latest\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull nginx:1.22.1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:8.0.21\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看安裝的镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"_2-构建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-构建镜像"}},[s._v("#")]),s._v(" 2.构建镜像")]),s._v(" "),a("p",[s._v("构建自己的镜像有两种方法：")]),s._v(" "),a("ul",[a("li",[s._v("使用 docker commit 命令")]),s._v(" "),a("li",[s._v("使用 Dockerfile 文件 & docker build 命令")])]),s._v(" "),a("h4",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),a("p",[s._v("在项目目录创建 "),a("a",{attrs:{href:"https://m.runoob.com/docker/docker-dockerfile.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Dockerfile"),a("OutboundLink")],1),s._v(" 文件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile\n\nFROM centos_v7.9-zh_cn-jdk8:220915001\nMAINTAINER Jun Yu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("work@yuwei.cc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" appuser\n"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" appuser\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /app/data\nADD xxx.tar.gz /app/\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" /app\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v("\nRUN "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-sf")]),s._v(" /dev/stdout /app/logs/stdout.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ENTRYPOINT java -jar /app/app.jar > /app/logs/stdout.log 2>&1")]),s._v("\nCMD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/app/bin/resatrt.sh && -f /app/logs/stdout.log"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("保存文件，执行命令进行构建")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" demo/test:v1 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" 指定 Dockerfile 文件所在路径和文件名 demo/test:v1 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("查看构建镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" demo/test:v1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect demo/test:v1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"四、目录挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、目录挂载"}},[s._v("#")]),s._v(" 四、目录挂载")]),s._v(" "),a("h3",{attrs:{id:"_1-可持久化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-可持久化"}},[s._v("#")]),s._v(" 1.可持久化")]),s._v(" "),a("p",[s._v("Docker 的镜像是只读的，容器是可写的；但是将数据写入到容器，一旦容器删除数据也将丢失，所以就需要将容器数据进行持久化存储")]),s._v(" "),a("h3",{attrs:{id:"_2-挂载方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-挂载方式"}},[s._v("#")]),s._v(" 2.挂载方式")]),s._v(" "),a("h4",{attrs:{id:"_2-1-bind-mount"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-bind-mount"}},[s._v("#")]),s._v(" 2.1.bind mount")]),s._v(" "),a("p",[s._v("将宿主机目录直接映射到容器，适合挂载依赖环境，如：Node、Java 等，可挂到多个容器上")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/node\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-itd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" Demo1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /opt/node:/node centos\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_2-2-volume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-volume"}},[s._v("#")]),s._v(" 2.2.volume")]),s._v(" "),a("p",[s._v("volume 由 Docker 来管理（创建、删除），创建在宿主机，存储空间来自于宿主机文件系统中的某个目录；所以删除容器不会丢失，官方推荐，适合存储数据，如 MySQL 数据，可挂到多个容器上")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建 volume")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create V_JDK\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看卷的参数信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect V_JDK\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#运行容器并挂载 volume")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-itd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" Demo2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" V_JDK centos\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看容器卷信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("容器名称/ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" volume\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看Docker数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除不用的数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume prune\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除一个或多个数据卷")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" xxx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"_2-3-tmpfs-mount"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-tmpfs-mount"}},[s._v("#")]),s._v(" 2.3.tmpfs mount")]),s._v(" "),a("p",[s._v("tmpfs 是将文件写到存宿主机内存中，避免增加容器大小，适合存储临时文件，不可多容器共享")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-itd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" Demo3 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tmpfs")]),s._v(" /demo centos\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-数据共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-数据共享"}},[s._v("#")]),s._v(" 3.数据共享")]),s._v(" "),a("h4",{attrs:{id:"_3-1-容器单独"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-容器单独"}},[s._v("#")]),s._v(" 3.1.容器单独")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("--volumes-from\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-itd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" Demo4 --volumes-from Demo1 --volumes-from Demo2 centos\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_3-2-使用-nfs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-使用-nfs"}},[s._v("#")]),s._v(" 3.2.使用 NFS")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--driver")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("o")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".254.100,rw "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--opt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("device")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(":/mnt/nfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  V_NFS\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"五、容器网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、容器网络"}},[s._v("#")]),s._v(" 五、容器网络")]),s._v(" "),a("p",[s._v("安装完 Docker 系统会自动添加一个供 Docker 使用的网桥"),a("code",[s._v("docker0")]),s._v("，共五种模式：")]),s._v(" "),a("ul",[a("li",[s._v("bridge：默认设置，为容器创建独立的网络命名空间，容器具有独立的网卡等所有单独的网络栈")]),s._v(" "),a("li",[s._v("host：这个模式下创建出来的容器，直接使用容器宿主机的网络命名空间，即使用宿主机的 IP 和端口")]),s._v(" "),a("li",[s._v("none：为容器创建独立网络命名空间，但不为它做任何网络配置，容器中只有 lo")]),s._v(" "),a("li",[s._v("container：指定一个已有的容器，共享该容器的 IP 和端口；--net=container:<容器名称/ID>")]),s._v(" "),a("li",[s._v("自定义：使用第三方的网络实现或者创建单独的 bridge 网络，提供网络隔离能力")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create N_Demo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-itd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" MyDB "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" N_Demo --network-alias mysql mysql:latest\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用相同网络的其他容器可以使用网络别名进行访问")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);