(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{428:function(s,a,t){"use strict";t.r(a);var e=t(3),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"脑裂原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#脑裂原因"}},[s._v("#")]),s._v(" 脑裂原因")]),s._v(" "),a("p",[s._v("让 master、slave 和 sentinel 三类节点处于不同的网络分区，此时哨兵无法感知到 master 的存在，会将 slave 提升为 master 节点，此时就会存在两个 master，原来的客户端继续往旧的 master 写入数据，而新的 master 就会丢失这些数据")]),s._v(" "),a("h2",{attrs:{id:"解决问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决问题"}},[s._v("#")]),s._v(" 解决问题")]),s._v(" "),a("p",[s._v("通过配置文件修改两个参数")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#表示连接到 master 最少 slave 的数量")]),s._v("\nmin-slaves-to-write "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#表示 slave 连接到 master 最大的延迟时间")]),s._v("\nmin-slaves-max-lag "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新版本写法")]),s._v("\nmin-replicas-to-write "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nmin-replicas-max-lag "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("配置这两个参数之后，如果发生集群脑裂，原先的 master 节点接收到写入请求就会拒绝，就会减少数据同步之后的数据丢失")])])}),[],!1,null,null,null);a.default=n.exports}}]);